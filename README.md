# vexa-ai

## تنظیم و استفاده از GPT

برای فعال‌سازی دستیار GPT (هم در مینی‌اپ و هم داخل ربات تلگرام) متغیرهای محیطی زیر را مقداردهی کنید:

- `GPT_API` یا `GPT_API_KEY` یا `OPENAI_API_KEY` — کلید دسترسی به سرویس GPT (الزامی).
- `GPT_API_URL` — آدرس سرویس چت، پیش‌فرض `https://api.openai.com/v1/chat/completions`.
- `GPT_MODEL` — نام مدل، پیش‌فرض `gpt-4o-mini`.
- `GPT_API_TIMEOUT` — زمان انتظار درخواست بر حسب ثانیه، پیش‌فرض `45`.
- `GPT_API_KEY_HEADER` و `GPT_API_KEY_PREFIX` — در صورت نیاز به هدر سفارشی برای کلید.
- `GPT_SYSTEM_PROMPT` — پیام سیستمی برای شروع هر مکالمه (پیش‌فرض: «You are Vexa GPT-5…»).
- `GPT_HISTORY_LIMIT` — تعداد پیام‌های اخیر که در هر پاسخ به GPT ارسال می‌شود (پیش‌فرض `6`).
- `GPT_TEMPERATURE` — میزان خلاقیت پاسخ‌ها (۰ تا ۲، پیش‌فرض `0.7`).
- `GPT_TOP_P` — مقدار `top_p` برای نمونه‌گیری هسته‌ای (۰ تا ۱، پیش‌فرض `1`).
- `GPT_MAX_TOKENS` — سقف توکن برای هر پاسخ (۰ یعنی بدون محدودیت جداگانه).
- `GPT_WEBAPP_URL` — آدرس مینی‌اپی که از همین پروژه سرو می‌شود (اختیاری).

## امکانات ربات

- دستور `/gpt` برای شروع گفت‌وگوی مستقیم با GPT در همان چت تلگرام. با دستور `/endgpt` می‌توانید مکالمه را پایان دهید و دکمه «شروع چت جدید ♻️» تاریخچه را پاک می‌کند.
- در منوی اصلی، دکمه GPT شما را به گفت‌وگوی درون ربات هدایت می‌کند و در صورت تنظیم `GPT_WEBAPP_URL`، دکمه جداگانه‌ای برای باز کردن مینی‌اپ وجود دارد.
- مسیر `/api/gpt` برای وب‌اپ آماده است و درخواست‌های کاربر را به سرویس GPT هدایت می‌کند. همه درخواست‌ها با مقادیر `temperature/top_p/max_tokens` تعریف‌شده در محیط ارسال می‌شوند و پیام‌های نامعتبر تاریخچه فیلتر می‌شوند تا خطایی سمت کاربر رخ ندهد.

پس از مقداردهی متغیرها، ربات آماده است تا پیام‌های کاربران را به سرویس GPT ارسال کرده و پاسخ را در تلگرام یا مینی‌اپ نمایش دهد.
